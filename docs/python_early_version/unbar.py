import numpy as np

def UNBAR(table, data_in):
    """ Interpolation Routine for Hydrazine and Reaction Products.  Data 
    from Kesten 'BLOCK DATA' in original fortran code """
        
    if table.upper() == 'TVAP':
        P_en  = [50.0, 100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0,
                 450.0, 500.0, 550.0, 600.0, 650.0, 700.0, 750.0, 800.0,
                 850.0, 900.0, 950.0, 1000.0]
        T_en = [770.0, 820.0, 855.0, 880.0, 905.0, 925.0, 945.0, 965.0,
                980.0, 995.0, 1010.0, 1025.0, 1035.0, 1050.0, 1060.0, 
                1070.0, 1080.0, 1090.0, 1100.0, 1110.0]
        calc_val = np.interp(data_in, P_en, T_en)  # [degR] Calculate Tvap
    
    elif table.upper() == 'DELHV':
        Tvap_en = [180.0, 360.0, 534.6, 540.0, 720.0, 900.0, 1080.0]
        DELHV_en = [1390.16, 1332.82, 1280.02, 1279.12, 1237.79, 1208.80, 1189.76]
        calc_val = np.interp(data_in, Tvap_en, DELHV_en)  # [?] Enthalpy of Vaporization 

    elif table.upper() == 'DELHL':
        Tvap_en = [180.0, 360.0, 534.6, 540.0, 720.0, 900.0, 1080.0]
        DELHV_en = [652.14, 665.96, 679.61, 679.89, 700.89, 733.19, 777.22]
        calc_val = np.interp(data_in, Tvap_en, DELHV_en)  # [?] Enthalpy of 
        
    elif table.upper() == 'ZTBLA':
        Z = [0.0, 0.0055, 0.0111, 0.0167, 0.0168, 0.0439, 0.0575, 0.0711, 
             0.0847, 0.0983, 0.1119, 0.1255, 0.1391, 0.1527, 0.1663, 0.1799, 
             0.1935, 0.2207, 0.2343, 0.2500]
        ZTBLA = [0.001, 0.001, 0.001, 0.001, 0.0064, 0.0064, 0.0064, 0.0064, 
                 0.0064, 0.0064, 0.0064, 0.0064, 0.0064, 0.0064, 0.0064, 
                 0.0064, 0.0064, 0.0064, 0.0064, 0.0064]
        calc_val = np.interp(data_in, Z, ZTBLA)  # [ft] Catalyst Particle Radii
        
    elif table.upper() == 'ZTBLAP':
        Z = [0.0, 0.0055, 0.0111, 0.0167, 0.0168, 0.0439, 0.0575, 0.0711, 
             0.0847, 0.0983, 0.1119, 0.1255, 0.1391, 0.1527, 0.1663, 0.1799, 
             0.1935, 0.2207, 0.2343, 0.2500]
        ZTBLAP = [2100.0, 2100.0, 2100.0, 2100.0, 330.0, 330.0, 330.0, 
                  330.0, 330.0, 330.0, 330.0, 330.0, 330.0, 330.0, 330.0, 
                  330.0, 330.0, 330.0, 330.0, 330.0]
        calc_val = np.interp(data_in, Z, ZTBLAP)  # [1/ft] Total External Surface of catalyst paricle per unit volume of bed

    elif table.upper() == 'ZTBLD':
        Z = [0.0, 0.0055, 0.0111, 0.0167, 0.0168, 0.0439, 0.0575, 0.0711, 
             0.0847, 0.0983, 0.1119, 0.1255, 0.1391, 0.1527, 0.1663, 0.1799, 
             0.1935, 0.2207, 0.2343, 0.2500]
        ZTBLD = [0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 
                 0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34, 0.34]
        calc_val = np.interp(data_in, Z, ZTBLD)  # [ft?] Catalyst Particle Diameters

    elif table.upper() == 'TBLVP':
        T = [492.0, 519.0, 528.37, 529.08, 534.60, 534.71, 538.84, 543.91, 
             545.73, 560.20, 569.98, 579.26, 579.48, 595.34, 610.13, 614.08, 
             618.07, 627.49, 628.82, 645.68, 650.76, 665.57, 674.99 ,686.13, 
             692.39, 697.47, 744.0, 798.0, 852.0, 942.0, 1032.0, 1122.0, 
             1176.0]
        TBLVP = [0.0520, 0.1479, 0.2011, 0.2069, 0.2398, 0.2436, 0.2823, 
                 0.2920, 0.3539, 0.5453, 0.7367, 0.9727, 0.9823, 1.510, 
                 2.204, 2.462, 2.740, 3.407, 3.562, 5.240, 5.971, 8.065, 
                 9.711, 11.91, 13.46, 14.70, 33.80, 73.48, 147.0, 382.1, 
                 823.0, 1528.0, 2131.0]
        calc_val = np.interp(data_in, T, TBLVP)  # [?] 

    elif table.upper() == 'TBLH4':
        T = [0.0, 180.0, 360.0, 536.4, 540.0, 720.0, 900.0, 1080.0, 1260.0, 
             1440.0, 1620.0, 1800.0, 1980.0, 2160.0, 2340.0, 2520.0, 
             2700.0, 2880.0, 3060.0]
        TBLH4 = [-1991.34, -1951.02, -1919.50, -1896.04, -1895.70, -1882.55, 
                 -1878.12, -1879.46, -1884.63, -1892.38, -1901.94, -1912.88, 
                 -1924.85, -1937.54, -1950.74, -1964.45, -1978.32, -1992.36, 
                 -2006.62]
        calc_val = np.interp(data_in, T, TBLH4)  # [?] 

    elif table.upper() == 'TBLH3':
        T = [0.0, 180.0, 360.0, 536.4, 540.0, 720.0, 900.0, 1080.0, 1260.0, 
             1440.0, 1620.0, 1800.0, 1980.0, 2160.0, 2340.0, 2520.0, 
             2700.0, 2880.0, 3060.0]
        TBLH3 = [983.07, 1055.57, 1103.97, 1159.35, 1160.40, 1213.46, 
                 1259.64, 1298.00, 1329.71, 1355.28, 1375.67, 1391.11, 
                 1402.52, 1410.13, 1414.57, 1416.37, 1416.05, 1414.15, 
                 1410.56]
        calc_val = np.interp(data_in, T, TBLH3)  # [?] 

    elif table.upper() == 'SHTBL1':
        T = [540.0, 720.0, 900.0, 1080.0, 1260.0, 1440.0, 1620.0, 1800.0, 
             1980.0, 2160.0, 2340.0, 2520.0, 2700.0, 2880.0, 3060.0]
        SHTBL1 = [0.3084, 0.4601, 0.5261, 0.5784, 0.6212, 0.6577, 0.6899, 
                  0.7185, 0.7442, 0.7673, 0.7879, 0.8063, 0.8226, 0.8373, 
                  0.8503]
        calc_val = np.interp(data_in, T, SHTBL1)  # [?] 

    elif table.upper() == 'SHTBL2':
        T = [540.0, 720.0, 900.0, 1080.0, 1260.0, 1440.0, 1620.0, 1800.0, 
             1980.0, 2160.0, 2340.0, 2520.0, 2700.0, 2880.0, 3060.0]
        SHTBL2 = [0.5005, 0.5424, 0.5891, 0.6344, 0.6773, 0.7176, 0.7553, 
                  0.7905, 0.8236, 0.8541, 0.8823, 0.9075, 0.9304, 0.9512, 
                  0.9697]
        calc_val = np.interp(data_in, T, SHTBL2)  # [?] 

    elif table.upper() == 'SHTBL3':
        T = [540.0, 720.0, 900.0, 1080.0, 1260.0, 1440.0, 1620.0, 1800.0, 
             1980.0, 2160.0, 2340.0, 2520.0, 2700.0, 2880.0, 3060.0]
        SHTBL3 = [0.2485, 0.2495, 0.2524, 0.2569, 0.2624, 0.2682, 0.2738, 
                  0.2790, 0.2836, 0.2878, 0.2914, 0.2946, 0.2974, 0.2998, 
                  0.3019]
        calc_val = np.interp(data_in, T, SHTBL3)  # [?] 

    elif table.upper() == 'SHTBL4':
        T = [540.0, 720.0, 900.0, 1080.0, 1260.0, 1440.0, 1620.0, 1800.0, 
             1980.0, 2160.0, 2340.0, 2520.0, 2700.0, 2880.0, 3060.0]
        SHTBL4 = [3.4194, 3.4596, 3.4685, 3.4765, 3.4899, 3.5151, 3.5454, 
                  3.5806, 3.6208, 3.6654, 3.7150, 3.7696, 3.8291, 3.8802, 
                  3.9288]
        calc_val = np.interp(data_in, T, SHTBL4)  # [?] 

    elif table.upper() == 'VISVST':
        T = [360.0, 540.0, 720.0, 900.0, 1080.0, 1260.0, 1440.0, 1620.0, 
             1800.0, 1980.0, 2160.0, 2340.0, 2520.0]
        VISVST = [0.048e-4, 0.070e-4, 0.093e-4, 0.117e-4, 0.141e-4, 0.164e-4, 
                  0.186e-4, 0.207e-4, 0.220e-4, 0.247e-4, 0.266e-4, 0.285e-4, 
                  0.302e-4]
        calc_val = np.interp(data_in, T, VISVST)  # [?] Viscosity Data for N2H4 (maybe N2H4, not sure)

    elif table.upper() == 'CFTBL4':
        T = [540.0, 720.0, 900.0, 1080.0, 1260.0, 1440.0, 1620.0, 
             1800.0, 1980.0, 2160.0, 2340.0, 2520.0, 2700.0, 2880.0, 3060.0]
        CFTBL4 = [0.3604, 0.4601, 0.5261, 0.5704, 0.6212, 0.6577, 0.6899, 
                  0.7185, 0.7442, 0.7673, 0.7879, 0.8063, 0.8226, 0.8373, 
                  0.8503]
        calc_val = np.interp(data_in, T, CFTBL4)  # [?] Specific Heat for hydrazine

    elif table.upper() == 'CFTBL3':
        T = [540.0, 720.0, 900.0, 1080.0, 1260.0, 1440.0, 1620.0, 
             1800.0, 1980.0, 2160.0, 2340.0, 2520.0, 2700.0, 2880.0, 3060.0]
        CFTBL3 = [0.5005, 0.5424, 0.5891, 0.6344, 0.6773, 0.7176, 0.7553, 
                  0.7905, 0.8236, 0.8541, 0.8823, 0.9075, 0.9304, 0.9512, 
                  0.9697]
        calc_val = np.interp(data_in, T, CFTBL3)  # [?] Specific heat for ammonia

    elif table.upper() == 'CFTBL2':
        T = [540.0, 720.0, 900.0, 1080.0, 1260.0, 1440.0, 1620.0, 
             1800.0, 1980.0, 2160.0, 2340.0, 2520.0, 2700.0, 2880.0, 3060.0]
        CFTBL2 = [0.2485, 0.2495, 0.2524, 0.2569, 0.2624, 0.2681, 0.2738, 
                  0.2790, 0.2836, 0.2878, 0.2914, 0.946, 0.2974, 0.2998, 
                  0.3019]
        calc_val = np.interp(data_in, T, CFTBL2)  # [?] Specific heat for nitrogen

    elif table.upper() == 'CFTBL1':
        T = [540.0, 720.0, 900.0, 1080.0, 1260.0, 1440.0, 1620.0, 
             1800.0, 1980.0, 2160.0, 2340.0, 2520.0, 2700.0, 2880.0, 3060.0]
        CFTBL1 = [3.4194, 3.4596, 3.4685, 3.4765, 3.4899, 3.5151, 3.5454, 
                  3.5006, 3.6208, 3.6654, 3.7150, 3.7696, 3.8291, 3.8802, 
                  3.9288]
        calc_val = np.interp(data_in, T, CFTBL1)  # [?] Specific heat for hydrogen
        
        
    elif table.upper() == 'H4TBL':
        T = [180.0, 360.0, 536.4, 540.0, 720.0, 900.0, 1080.0, 1260.0, 
             1440.0, 1620.0, 1800.0, 1980.0, 2160.0, 2340.0, 2520.0, 
             2700.0, 2880.0, 3060.0]
        TBLH4 = [-1951.02, -1919.50, -1896.04, -1895.70, -1882.55, 
                 -1878.12, -1879.46, -1884.63, -1892.38, -1901.94, 
                 -1912.88, -1924.85, -1937.54, -1950.74, -1964.45, 
                 -1970.32, -1992.36, -2006.62]
        calc_val = np.interp(data_in, T, TBLH4)  # [?] Heats of Reaction

    elif table.upper() == 'H3TBL':
        T = [180.0, 360.0, 536.4, 540.0, 720.0, 900.0, 1080.0, 1260.0, 
             1440.0, 1620.0, 1800.0, 1980.0, 2160.0, 2340.0, 2520.0, 
             2700.0, 2880.0, 3060.0]
        TBLH3 = [1055.57, 1103.97, 1159.35, 1160.40, 1213.46, 1259.64, 
                 1298.00, 1329.71, 1355.28, 1375.57, 1391.11, 1402.52, 
                 1410.13, 1414.57, 1416.37, 1416.05, 1414.15, 1410.56]
        calc_val = np.interp(data_in, T, TBLH3)  # [?] Heats of Reaction

    elif table.upper() == 'DHVST':
        T     =   [180.0,   360.0,  534.6,   540.0,   720.0,   900.0,  1080.0]
        DHVST = [1390.16, 1332.82, 1280.2, 1279.12, 1237.79, 1208.80, 1189.76]
        calc_val = np.interp(data_in, T, DHVST)  # [?] 

    elif table.upper() == 'DHLVST':
        T      = [ 180.0,  360.0, 534.6,   540.0,  720.0,  900.0, 1080.0]
        DHLVST = [652.14, 665.96, 679.61, 679.89, 700.89, 733.19, 777.22]
        calc_val = np.interp(data_in, T, DHLVST)  # [?]

    else:
        print(f'ERROR - table: {table}, value: {data_in} not calculated correctly')
        calc_val = -1
    return calc_val


